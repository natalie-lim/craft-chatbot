(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[853],{1439:(e,t,s)=>{"use strict";s.d(t,{CN:()=>i,HW:()=>u,Mn:()=>c,db:()=>d,j2:()=>l});var a=s(3915),n=s(6203),r=s(5317);let i={apiKey:"AIzaSyCXwVaGeaL1656E9A30UV9XR2zk3SJwDZ4",authDomain:"task-manager-4f8be.firebaseapp.com",projectId:"task-manager-4f8be",storageBucket:"task-manager-4f8be.firebasestorage.app",messagingSenderId:"299806984749",appId:"1:299806984749:web:98f92c253605d5107246a4"},o=0===(0,a.Dk)().length?(0,a.Wp)(i):(0,a.Dk)()[0],l=(0,n.xI)(o),c=new n.HF,d=(0,r.aU)(o);async function u(){return new Promise((e,t)=>{let s=(0,n.hg)(l,t=>{s(),e(t)},t)})}},2857:(e,t,s)=>{Promise.resolve().then(s.bind(s,5123))},5123:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j,deleteTaskFromFirestore:()=>k});var a=s(5155),n=s(2115),r=s(5294),i=s(4725),o=s.n(i),l=s(5317),c=s(9774),d=s.n(c),u=s(2418),f=s(6670),p=s(1439);function h(e){let{col:t,title:s,colorInput:r,taskIndex:i,taskMap:o}=e,[c,h]=(0,n.useState)(""),[m,x]=(0,n.useState)(s||""),[g,k]=(0,n.useState)(!1),[j,w]=(0,n.useState)(!1),[b,v]=(0,n.useState)(!1),[y,N]=(0,n.useState)(null),D=i[t];(0,n.useEffect)(()=>{void 0!==r?h(r):h(function(){let e=Math.floor(360*Math.random());return"hsl(".concat(e,", 70%, 85%)")}()),(async()=>{N(await (0,p.HW)())})(),w(!0)},[r]),(0,n.useEffect)(()=>{x(s||"")},[s]);let I=async e=>{let t=e.target.value;if(x(t),!b&&y){v(!0);try{let e=(0,l.H9)(p.db,"userInfo",y.uid);await (0,l.mZ)(e,{["tasks.".concat(D,".headerDescription")]:t})}catch(e){console.error("Error updating title:",e)}finally{setTimeout(()=>v(!1),300)}}},S=async e=>{if(h(e),y)try{let t=(0,l.H9)(p.db,"userInfo",y.uid);await (0,l.mZ)(t,{["tasks.".concat(D,".color")]:e})}catch(e){console.error("Error updating color:",e)}},C=async()=>{if(y)try{let e=(0,l.H9)(p.db,"userInfo",y.uid),t=await (0,l.x7)(e);if(!t.exists())return void console.error("Document not found");let s=(t.data().tasks||{})[D];if(!s)return void console.error("Column not found in document");let a=[...s.taskDescriptions||[]];a.push(""),await (0,l.mZ)(e,{["tasks.".concat(D,".taskDescriptions")]:a})}catch(e){console.error("Error adding task:",e)}};return(0,a.jsx)("div",{className:"w-full relative",children:(0,a.jsxs)("div",{className:"flex h-10 p-2 items-center justify-between",style:{backgroundColor:c},children:[(0,a.jsx)("input",{className:"".concat(d().className," text-xl bg-transparent outline-none w-full"),value:m,placeholder:"Column Title",onChange:I,disabled:b}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 z-10",children:[j&&(0,a.jsx)(u.A,{trigger:(0,a.jsx)("button",{onClick:()=>k(!g),children:(0,a.jsx)("img",{src:"../assets/pencil.svg",alt:"edit",width:18,height:18})}),position:"bottom center",onOpen:()=>k(!0),onClose:()=>k(!1),children:(0,a.jsx)(f.jI,{color:c,onChange:S})}),(0,a.jsx)("button",{onClick:C,children:(0,a.jsx)("img",{src:"../assets/plus-square.svg",alt:"add task",width:20,height:20})})]})]})})}var m=s(7200),x=s.n(m);function g(e){let{description:t,column:s,index:r}=e,[i,o]=(0,n.useState)(t),[c,d]=(0,n.useState)(!1),[f,h]=(0,n.useState)(""),m=async()=>{try{let e=await fetch("/api/suggest",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:"Give suggestions for: ".concat(i)})});return(await e.json()).result}catch(e){return console.error("Failed to fetch AI suggestion:",e),"Error retrieving suggestion."}};(0,n.useEffect)(()=>{o(t)},[t]);let g=async e=>{let t=e.target.value;if(o(t),!c){d(!0);try{let e=(0,p.HW)(),a=(0,l.H9)(p.db,"userInfo",e.uid),n=await (0,l.x7)(a);if(!n.exists())return void console.error("Document not found");let i=(n.data().tasks||{})[s];if(!i)return void console.error("Column not found in document");let o=[...i.taskDescriptions||[]];o[r]=t,await (0,l.mZ)(a,{["tasks.".concat(s,".taskDescriptions")]:o}),console.log("Task updated: column ".concat(s,", index ").concat(r))}catch(e){console.error("Error updating task:",e)}finally{setTimeout(()=>d(!1),300)}}};return(0,a.jsxs)("div",{className:"w-full flex flex-row justify-between items-center",children:[(0,a.jsx)(u.A,{trigger:(0,a.jsx)("button",{className:"pr-2",children:(0,a.jsx)("img",{src:"../assets/Key.svg",alt:"ai help",width:20,height:20})}),position:"bottom center",closeOnDocumentClick:!0,onOpen:async()=>{h("Loading..."),h(await m())},children:(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"".concat(x().className," text-sm min-h-56 rounded shadow p-4 text-black"),style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:(e=>{let[t,s,a]=e;return"#".concat([t,s,a].map(e=>e.toString(16).padStart(2,"0")).join(""))})(((e,t,s)=>{let a=t=>(t+e/30)%12,n=(t/=100)*Math.min(s/=100,1-s),r=e=>Math.round(255*(s-n*Math.max(-1,Math.min(a(e)-3,Math.min(9-a(e),1)))));return[r(0),r(8),r(4)]})(Math.floor(360*Math.random()),70,85)),zIndex:50},children:[(0,a.jsxs)("p",{children:["AI suggestion for: ",(0,a.jsx)("strong",{children:i})]}),(0,a.jsx)("div",{className:"w-full min-h-48 mt-4 bg-white p-2 rounded overflow-auto",children:f})]})})}),(0,a.jsx)("input",{className:"".concat(x().className," text-sm w-full bg-transparent outline-none flex-grow"),value:i,placeholder:"insert task",onChange:g})]})}async function k(e,t,s){let a=await (0,p.HW)();if(!a)return;let n={...e},r=[...n[t].taskDescriptions];r.splice(s,1),n[t]={...n[t],taskDescriptions:r};let i=(0,l.H9)(p.db,"userInfo",a.uid);await (0,l.mZ)(i,{tasks:n})}function j(){let[e,t]=(0,n.useState)({}),[s,i]=(0,n.useState)([]),[c,d]=(0,n.useState)(""),[u,f]=(0,n.useState)(!0);async function m(a){let{source:n,destination:r}=a;if(!r)return;let i=parseInt(n.droppableId),o=parseInt(r.droppableId),c=s[i],d=s[o],u=structuredClone(e);if(c===d){let e=[...u[c].taskDescriptions],[t]=e.splice(n.index,1);e.splice(r.index,0,t),u[c].taskDescriptions=e}else{let e=[...u[c].taskDescriptions],t=[...u[d].taskDescriptions],[s]=e.splice(n.index,1);t.splice(r.index,0,s),u[c].taskDescriptions=e,u[d].taskDescriptions=t}t(u);let f=await (0,p.HW)(),h=(0,l.H9)(p.db,"userInfo",f.uid);await (0,l.mZ)(h,{tasks:u})}(0,n.useEffect)(()=>{let e;return(async()=>{let s=await (0,p.HW)();if(!s)return;let a=(0,l.H9)(p.db,"userInfo",s.uid);e=(0,l.aQ)(a,e=>{if(e.exists()){let s=e.data();d(s.displayName||"friend");let a=s.tasks||{};t(a),i(Object.keys(a)),f(!1)}else console.log("No such document!"),f(!1)})})(),()=>{e&&e()}},[]);let x=(t,n)=>{var i;return((null==(i=e[t])?void 0:i.taskDescriptions)||[]).map((n,i)=>{let o="task-".concat(t,"-").concat(i,"-").concat(n);return(0,a.jsx)(r.sx,{draggableId:o,index:i,children:(r,o)=>(0,a.jsx)("div",{ref:r.innerRef,...r.draggableProps,...r.dragHandleProps,className:"select-none p-2 w-full justify-center items-center mb-2 rounded border transition-all duration-200 ".concat(o.isDragging?"bg-gray-200 border-white opacity-50":"bg-white border-gray-300 opacity-100"),children:(0,a.jsxs)("div",{className:"flex items-center w-full",children:[(0,a.jsx)("div",{className:"flex-grow",children:(0,a.jsx)(g,{description:n,column:t,index:i,taskIndex:s})}),(0,a.jsx)("button",{onClick:async()=>{await k(e,t,i)},className:"ml-4 text-red-500 hover:text-red-700 text-sm shrink-0",children:"âœ•"})]})})},o)})};return u?(0,a.jsx)("div",{className:"pt-12 flex flex-col items-center justify-center",children:(0,a.jsx)("h1",{className:"".concat(o().className," text-5xl"),children:"Loading..."})}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"pt-12 flex flex-col items-center justify-center",children:[(0,a.jsx)("h1",{className:"".concat(o().className," text-5xl"),children:"tasks"}),(0,a.jsxs)("h2",{className:"".concat(o().className," text-xl pt-4"),children:["Seize the day ",c]})]}),(0,a.jsx)("div",{className:"flex items-center justify-center w-full",children:(0,a.jsx)("div",{className:"flex flex-row",children:(0,a.jsx)("div",{className:"flex align-top gap-1 m-8 overflow-x-auto",children:(0,a.jsx)(r.JY,{onDragEnd:m,children:s.map((t,n)=>(0,a.jsx)(r.gL,{droppableId:"".concat(n),children:(r,i)=>{var o,l;return(0,a.jsxs)("div",{ref:r.innerRef,...r.droppableProps,className:"min-h-[100px] align-top rounded shadow transition-colors ".concat(i.isDraggingOver?"bg-gray-100":"white"),children:[(0,a.jsx)(h,{col:n,title:null==(o=e[t])?void 0:o.headerDescription,colorInput:null==(l=e[t])?void 0:l.color,taskIndex:s,taskMap:e}),x(t,n),r.placeholder]})}},t))})})})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[393,992,965,309,342,234,441,684,358],()=>t(2857)),_N_E=e.O()}]);